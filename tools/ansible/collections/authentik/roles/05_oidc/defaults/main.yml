# OIDC Provider Configurations
#
# Automatically configured:
# - signing_key: Authentik Self-signed Certificate
# - property_mappings: openid, email, profile scopes
#
# Optional fields:
# - logout_url: Backchannel logout URL (only Zammad supports this)
# - icon: Local icon filename from files/icons/ (uploaded to Authentik)
# - use_verified_email: true - use custom email scope returning email_verified: true
#   (required for apps like Vaultwarden that check the email_verified claim)
#
# Note: SigNoz uses ForwardAuth (06_proxy role) - OIDC is enterprise-only
# Note: Actual provider config is in vars/oidc-providers.yml (overrides this file)
---
oidc_providers:
  - name: zammad-oidc
    app_name: Zammad
    app_slug: zammad
    icon: "zammad.png"
    redirect_uris:
      - url: "https://app.example.com/auth/openid_connect/callback"
        matching_mode: "strict"
    logout_url: "https://app.example.com/auth/openid_connect/backchannel_logout"
    # Client ID/Secret: ansible-vault view vars/oidc-credentials.yml
    # Config: Zammad Admin UI → Settings → Security → Third Party → OpenID Connect

  - name: headscale-oidc
    app_name: Headscale VPN
    app_slug: headscale
    icon: "headscale.svg"
    show_in_library: false  # VPN client - hidden from library
    redirect_uris:
      - url: "https://vpn.example.com/oidc/callback"
        matching_mode: "strict"
    # No logout_url - Headscale uses node expiration (oidc.expiry or token-based)
    # Client ID/Secret stored in: example/secrets/headscale
    # Issuer URL: https://auth.example.com/application/o/headscale/

  - name: headplane-oidc
    app_name: Headplane Admin
    app_slug: headplane
    icon: "headscale.svg"
    redirect_uris:
      - url: "https://vpn.example.com/admin/oidc/callback"
        matching_mode: "strict"
    # No logout_url - Headplane doesn't support backchannel logout
    # Client ID/Secret: ansible-vault view vars/oidc-credentials.yml
    # Config: Ansible vars → vars/headscale.yml (headplane_oidc_*)
    # Issuer URL: https://auth.example.com/application/o/headplane/
